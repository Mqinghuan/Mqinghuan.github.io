<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚óç‚Ä¢·¥ó‚Ä¢‚óç</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(135deg, #ffe6f0, #ffcce6, #ffb3d9);
      height: 100vh;
      overflow: hidden;
      position: relative;
      font-family: "Microsoft YaHei", cursive;
    }

    .bubble {
      position: absolute;
      pointer-events: auto;
      cursor: pointer;
      border-radius: 50%;
      opacity: 0;
      will-change: transform, opacity;
    }

    .bubble::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: 
        radial-gradient(circle at 25% 20%, rgba(255,255,255,0.4), transparent 45%),
        conic-gradient(
          from var(--rotate, 0deg),
          rgba(255,182,220,0.35),
          rgba(182,220,255,0.35),
          rgba(220,255,182,0.25),
          rgba(255,220,182,0.35),
          rgba(255,182,220,0.35)
        );
      box-shadow: inset 0 0 20px rgba(255,255,255,0.1);
    }

    .bubble::after {
      content: '';
      position: absolute;
      top: 15%;
      left: 22%;
      width: 22%;
      height: 22%;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.75);
      filter: blur(1px);
    }

    .bubble-inner {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #d0508f;
      font-weight: bold;
      text-align: center;
      padding: 0.3em;
      text-shadow:
        1px 1px 0 #fff,
        -1px -1px 0 #fff,
        1px -1px 0 #fff,
        -1px 1px 0 #fff,
        0 0 6px rgba(255, 255, 255, 0.9);
      line-height: 1.2;
      font-size: 14px;
      z-index: 2;
      pointer-events: none;
    }

    .heart-particle {
      position: absolute;
      pointer-events: none;
      font-size: 20px;
      opacity: 0;
      user-select: none;
      z-index: 9998;
    }

    #big-heart {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 300px;
      opacity: 0;
      color: #ff3385;
      text-shadow: 
        0 0 40px rgba(255, 51, 133, 0.9),
        0 0 80px rgba(255, 105, 180, 0.7),
        0 0 120px rgba(255, 150, 200, 0.5);
      pointer-events: none;
      z-index: 9999;
      white-space: nowrap;
    }
  </style>
</head>
<body>

<div id="big-heart">‚ù§Ô∏è</div>

<script>
  const loveMessages = [
    'ÂñúÊ¨¢‰Ω†', '‰∏é‰Ω†Áõ∏ÈÅáÂ•ΩÂπ∏Ëøê',
    'ÂøÉÂä®ÊòØ‰Ω†', '‰∏ñÁïåÂõ†‰Ω†ËÄåÁæéÂ•Ω', 'Êä±Êä±',
    'Êú™Êù•ËØ∑Â§öÊåáÊïô', '‰ªäÂ§©‰πüÊÉ≥ËßÅ‰Ω†',
    'Êúâ‰Ω†Âú®Â∞±ÂæàÂÆâÂøÉ', 'ÂñúÊ¨¢‰∏çÁî±Ëá™‰∏ª',
    '‰ªäÊôöÊúàËâ≤ÁúüÁæé'
  ];

  let isAnimatingHeart = false;
  const activeBubbles = new Set();
  const MAX_BUBBLES = 150; // ÊéßÂà∂ÊÄªÊï∞ÔºåÈò≤Âç°È°ø

  function createBubble() {
    if (isAnimatingHeart || activeBubbles.size >= MAX_BUBBLES) return;

    const bubble = document.createElement('div');
    bubble.classList.add('bubble');

    // üéØ Ë∞ÉÊï¥Â∞∫ÂØ∏ÂàÜÂ∏ÉÔºöÂèñÊ∂àË∂ÖÂ∞èÊ≥°Ê≥°ÔºåÊï¥‰ΩìÊõ¥Â§ßÊõ¥È•±Êª°
    const rand = Math.random();
    let size;
    if (rand < 0.6) {
      size = 30 + Math.random() * 30;   // Â∞èÊ≥°Ê≥°Ôºö30~60pxÔºàÂç† 60%Ôºå‰ΩÜ‰∏çÂÜç‚ÄúÂ§™Â∞è‚ÄùÔºâ
    } else if (rand < 0.9) {
      size = 60 + Math.random() * 40;   // ‰∏≠Ê≥°Ê≥°Ôºö60~100px
    } else {
      size = 100 + Math.random() * 50;  // Â§ßÊ≥°Ê≥°Ôºö100~150px
    }

    bubble.style.width = `${size}px`;
    bubble.style.height = `${size}px`;

    const startX = Math.random() * (window.innerWidth - size);
    const startY = window.innerHeight + size;
    bubble.style.left = `${startX}px`;
    bubble.style.top = `${startY}px`;
    bubble.style.setProperty('--rotate', `${Math.random() * 360}deg`);

    // ÈÄèÊòéÂ∫¶ÂæÆË∞ÉÔºöÂ∞èÊ≥°Ê≥°Á®çÊ∑°ÔºåÂ§ßÊ≥°Ê≥°Êõ¥ÂÆû
    if (size < 50) {
      bubble.style.opacity = '0.6';
    } else if (size < 80) {
      bubble.style.opacity = '0.75';
    } else {
      bubble.style.opacity = '0.9';
    }

    document.body.appendChild(bubble);
    activeBubbles.add(bubble);

    const baseDuration = size < 60 ? 14000 : 10000;
    const duration = baseDuration + (Math.random() - 0.5) * 3000;

    const anim = bubble.animate([
      { top: `${startY}px`, opacity: 0, transform: 'scale(0.3)' },
      { 
        top: `-${size * 2}px`, 
        opacity: size < 50 ? 0.6 : (size < 80 ? 0.75 : 0.9), 
        transform: `scale(${0.9 + size/200}) translateX(${(Math.random() - 0.5) * 60}px)` 
      }
    ], {
      duration: duration,
      easing: 'cubic-bezier(0.2, 0.6, 0.4, 0.9)',
      fill: 'forwards'
    });

    // üí¨ Âè™Êúâ ‚â•70px ÁöÑÊ≥°Ê≥°ÊâçÂèØËÉΩÂ∏¶Â≠óÔºå‰∏îÊ¶ÇÁéá‰ªÖ 40%
    if (size >= 70 && Math.random() > 0.6) {
      const inner = document.createElement('div');
      inner.classList.add('bubble-inner');
      inner.textContent = loveMessages[Math.floor(Math.random() * loveMessages.length)];
      const fontSize = Math.min(size / 3.8, 28);
      inner.style.fontSize = `${Math.max(14, fontSize)}px`;
      bubble.appendChild(inner);
    }

    bubble.addEventListener('click', () => {
      popBubble(bubble, bubble.getBoundingClientRect());
      removeBubble(bubble);
    });

    setTimeout(() => removeBubble(bubble), duration + 1000);
  }

  function removeBubble(bubble) {
    if (activeBubbles.has(bubble)) {
      activeBubbles.delete(bubble);
      if (bubble.parentNode) bubble.remove();
    }
  }

  function popBubble(element, rect) {
    const count = 5 + Math.floor(Math.random() * 3);
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;

    for (let i = 0; i < count; i++) {
      const heart = document.createElement('div');
      heart.classList.add('heart-particle');
      heart.innerHTML = '‚ù§Ô∏è';
      heart.style.left = `${centerX}px`;
      heart.style.top = `${centerY}px`;
      document.body.appendChild(heart);

      const angle = Math.random() * Math.PI * 2;
      const distance = 20 + Math.random() * 40;
      const anim = heart.animate([
        { transform: 'translate(0,0) scale(1)', opacity: 1 },
        { transform: `translate(${Math.cos(angle)*distance}px, ${Math.sin(angle)*distance - 10}px) scale(0)`, opacity: 0 }
      ], {
        duration: 500 + Math.random() * 300,
        easing: 'cubic-bezier(0.2, 0.8, 0.4, 1)'
      });
      anim.onfinish = () => heart.remove();
    }
  }

  // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî Áà±ÂøÉÂä®ÁîªÔºà‰∏çÂèòÔºâ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
  async function showBigHeartAndExplode() {
    while (activeBubbles.size < 50 && !isAnimatingHeart) {
      await new Promise(r => setTimeout(r, 300));
    }

    isAnimatingHeart = true;

    activeBubbles.forEach(b => {
      b.style.transition = 'opacity 0.4s ease-out';
      b.style.opacity = '0';
    });
    await new Promise(r => setTimeout(r, 400));

    activeBubbles.forEach(b => {
      if (b.parentNode) b.remove();
    });
    activeBubbles.clear();

    const bigHeart = document.getElementById('big-heart');
    bigHeart.style.opacity = '1';

    await new Promise(r => {
      bigHeart.animate([
        { transform: 'translate(-50%, -50%) scale(0)', opacity: 0 },
        { transform: 'translate(-50%, -50%) scale(1.1)', opacity: 1 },
        { transform: 'translate(-50%, -50%) scale(1)', opacity: 1 }
      ], {
        duration: 1000,
        easing: 'cubic-bezier(0.17, 0.67, 0.12, 1.01)',
        fill: 'forwards'
      }).onfinish = r;
    });

    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;

    for (let i = 0; i < 80; i++) {
      const heart = document.createElement('div');
      heart.classList.add('heart-particle');
      heart.innerHTML = '‚ù§Ô∏è';
      heart.style.left = `${centerX}px`;
      heart.style.top = `${centerY}px`;
      heart.style.fontSize = `${16 + Math.random() * 18}px`;
      document.body.appendChild(heart);

      const angle = (i / 80) * Math.PI * 2 + (Math.random() - 0.5) * 0.4;
      const distance = 220 + Math.random() * 200;
      heart.animate([
        { transform: 'translate(0,0) scale(1.2)', opacity: 1 },
        { transform: `translate(${Math.cos(angle)*distance}px, ${Math.sin(angle)*distance}px) scale(0)`, opacity: 0 }
      ], {
        duration: 1400 + Math.random() * 700,
        easing: 'cubic-bezier(0.1, 0.9, 0.4, 1)'
      }).onfinish = () => heart.remove();
    }

    bigHeart.animate([
      { opacity: 1 },
      { opacity: 0 }
    ], {
      duration: 1000,
      easing: 'ease-out',
      fill: 'forwards'
    });

    await new Promise(r => setTimeout(r, 1200));
    isAnimatingHeart = false;
  }

  // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî Ê≥°Ê≥°ÁîüÊàêÔºàÊØè 50ms ‰∏Ä‰∏™ÔºåÂØÜÈõÜ‰ΩÜ‰∏çÂç°Ôºâ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
  let lastBubbleTime = 0;
  const BUBBLE_INTERVAL = 50; // ‚âà20‰∏™/Áßí

  function bubbleLoop(timestamp) {
    if (timestamp - lastBubbleTime > BUBBLE_INTERVAL) {
      createBubble();
      lastBubbleTime = timestamp;
    }
    requestAnimationFrame(bubbleLoop);
  }

  requestAnimationFrame(bubbleLoop);

  setTimeout(() => {
    showBigHeartAndExplode();
    setInterval(showBigHeartAndExplode, 20000);
  }, 8000);
</script>
</body>

</html>
